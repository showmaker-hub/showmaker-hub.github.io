var y=(t,e,n)=>{let r=n[0],{position:l,word:o}=r,i=[],s=new Set;for(;l+o.length<=e&&0!==n.length;){s.add(o),i.push({position:l,length:o.length});var h=l+o.length;for(n.shift();0!==n.length&&(r=n[0],l=r.position,o=r.word,h>l);)n.shift()}return{hits:i,start:t,end:e,count:s.size}},L=(t,l,o=!1)=>{let i=[],s=new Set;return t.forEach(n=>{var r=n.length;if(0!==r){let t=0,e;for(o||(l=l.toLowerCase(),n=n.toLowerCase());-1<(e=l.indexOf(n,t));)i.push({position:e,word:n}),s.add(n),t=e+r}}),i.sort((t,e)=>t.position!==e.position?t.position-e.position:e.word.length-t.word.length),[i,s]},S=(t,e)=>{let n="",r=e.start;for(var{position:l,length:o}of e.hits)n+=t.substring(r,l),r=l+o,n+=`<mark class="search-keyword">${t.substr(l,o)}</mark>`;return n+=t.substring(r,e.end),n},b=(t,e,n)=>{if(t){let l=[],o=document.getElementById(e),i=document.getElementById(n);{let e=!t.endsWith("json");fetch(t).then(t=>t.text()).then(t=>{l=e?[...(new DOMParser).parseFromString(t,"text/xml").querySelectorAll("entry")].map(t=>({title:t.querySelector("title").textContent,content:t.querySelector("content").textContent,url:t.querySelector("url").textContent})):JSON.parse(t),l=l.filter(t=>t.title).map(t=>(t.title=t.title.trim(),t.content=t.content?t.content.trim().replace(/<[^>]+>/g,""):"",t.url=decodeURIComponent(t.url).replace(/\/{2,}/g,"/"),t)),o&&o.addEventListener("input",()=>{let t=o.value.trim().toLowerCase(),e=t.split(/[-\s]+/),n=[];0<t.length&&(n=(d=>{let g=[];return l.forEach(({title:r,content:l,url:o})=>{var[i,s]=L(d,r),[h,a]=L(d,l),s=new Set([...s,...a]).size,a=i.length+h.length;if(0!==a){let t=[],e=(0!==i.length&&t.push(y(0,r.length,i)),[]);for(;0!==h.length;){var u=h[0]["position"],c=Math.max(0,u-20),u=Math.min(l.length,u+80);e.push(y(c,u,h))}e.sort((t,e)=>t.count!==e.count?e.count-t.count:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start);let n="";(o=new URL(o,location.origin)).searchParams.append("highlight",d.join(" ")),0!==t.length?n+=`<li><a href="${o.href}" class="search-result-title">${S(r,t[0])}</a>`:n+=`<li><a href="${o.href}" class="search-result-title">${r}</a>`,e.forEach(t=>{n+=`<a href="${o.href}"><p class="search-result">${S(l,t)}...</p></a>`}),n+="</li>",g.push({item:n,id:g.length,hitCount:a,includedCount:s})}}),g})(e)),n.sort((t,e)=>t.includedCount!==e.includedCount?e.includedCount-t.includedCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id);var r=window.CONFIG.i18n.hits.replace(/\$\{hits}/,n.length);i.innerHTML=`<div class="search-stats">${r}</div>
            <ul class="search-result-list">${n.map(t=>t.item).join("")}</ul>`})})}}else console.warn("`hexo-generator-searchdb` plugin is not installed!")};document.addEventListener("DOMContentLoaded",()=>{b(window.CONFIG.local_search.path,"local-search-input","local-search-result")});